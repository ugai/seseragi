import { AboutSlint, Button, VerticalBox, GridBox, LineEdit, HorizontalBox, Palette, ScrollView, StandardButton } from "std-widgets.slint";

export component AppWindow inherits Window {
    title: app_name;
    icon: @image-url("../asset/icon-64.png");
    preferred-width: 500px;
    preferred-height: 500px;

    in property <string> app_name;
    in property <string> app_description;
    in property <string> app_version;
    in property <string> app_url;
    in-out property <bool> file_opened;
    in-out property <string> file_path;
    in-out property <string> tree_text;
    in-out property <[string]> tree_list;

    callback open_button_clicked <=> open_button.clicked;
    callback reload_button_clicked <=> reload_button.clicked;
    callback reload_file;

    about_popup := PopupWindow { 
        x: 1rem;
        y: 1rem;
        width: root.width;

        Rectangle {
            background: Palette.background;
            border-color: Palette.border;
    
            VerticalBox {
                HorizontalBox  { 
                    Image {
                        source: @image-url("../asset/icon-512.png");
                        width: 96px;
                        height: 96px;
                        padding-right: 16px;
                    }
                    VerticalLayout {
                        HorizontalLayout {
                            Text {
                                text: app_name;
                                font-size: 2rem;
                                font-weight: 900;
                            }
                            Text { 
                                text: " v\{app_version}";
                                vertical-alignment: center;
                                horizontal-stretch: 1;
                            }
                        }
                        Text { text: app_description; wrap: word-wrap; }
                        Text { text: app_url; }
                    }
                }
    
                AboutSlint { preferred-height: 100px; }
            }
        }
    }

    VerticalBox {
        HorizontalBox {
            open_button := Button {
                text: "📂 Open...";
                horizontal-stretch: 1;
            }
            reload_button := Button {
                text: "🔄️ Reload";
                enabled: file_opened;
                horizontal-stretch: 1;
            }
            about_button := Button {
                text: "❔";
                clicked => { about_popup.show(); }
            }
        }

        HorizontalBox {
            Text {
                text: "File: ";
                visible: file_path != "";
                horizontal-stretch: 0;
            }
            Text {
                text: file_path;
                horizontal-alignment: left;
                horizontal-stretch: 1;
            }
        }

        ScrollView {
            preferred-width: scroll_inner.preferred-width;
            preferred-height: scroll_inner.preferred-height;

            scroll_inner := VerticalBox {
                Text {
                    text: tree_text;
                    vertical-alignment: top;
                }
            }
        }
    }
}
